// Generated by CoffeeScript 1.9.2
(function() {
  angular.module("DictionaryGame").controller("GameCtrl", [
    "$scope", function($scope) {
      $scope.socket = io();
      $scope.definitions = [];
      $scope.placeholder = "Enter a definition for the word here.";
      $scope.voted = -1;
      $scope.canVote = true;
      $scope.submitButton = "Submit";
      $scope.word = "";
      $scope.showInput = true;
      $scope.players = [];
      $scope.roomId = $("#roomId").html();
      $scope.socket.emit("join", {
        roomId: $scope.roomId
      });
      $scope.socket.on("word", function(data) {
        $scope.word = data.word;
        return $scope.$apply();
      });
      $scope.socket.on("done", function(data) {
        return console.log(data);
      });
      $scope.socket.on("playerJoin", function(data) {
        $scope.players.push(data);
        return $scope.$apply();
      });
      $scope.socket.on("playerLeave", function(data) {
        var j, len, player, ref;
        ref = $scope.players;
        for (j = 0, len = ref.length; j < len; j++) {
          player = ref[j];
          $scope.players.forEach(function(player, i) {
            if (player.username === data.username) {
              return $scope.players.splice(i, 1);
            }
          });
        }
        return $scope.$apply();
      });
      $scope.socket.on("message", function(data) {
        if (data.error != null) {
          console.log("Error: " + data.error);
        }
        if (data.message != null) {
          return console.log("Message: " + data.message);
        }
      });
      $scope.socket.on("hideInput", function(data) {
        $scope.showInput = false;
        return $scope.$apply();
      });
      $scope.socket.on("definition", function(data) {
        $scope.definitions.push(data);
        return $scope.$apply();
      });
      $scope.submitDefinition = function() {
        if ($scope.definition != null) {
          $scope.socket.emit("definition", {
            definition: $scope.definition
          });
          return $scope.showInput = false;
        }
      };
      return $scope.vote = function(index) {
        if ($scope.voted === -1) {
          return $scope.voted = index;
        }
      };
    }
  ]);

}).call(this);
